<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Article</title>
  <style>
:root{
  --maxw: 880px;
  --text: #111;
  --muted: #666;
  --border: #e5e5e5;
  --soft: #f7f7f7;
  --accent: #0b57d0;
}

body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  margin:0;
  line-height:1.7;
  color:var(--text);
}

header{
  padding:16px;
  border-bottom:1px solid var(--border);
}

main{
  max-width:var(--maxw);
  margin:0 auto;
  padding:20px 16px 48px;
}

a{
  color:var(--accent);
  text-decoration:none;
}
a:hover{ text-decoration:underline; }

.muted{
  color:var(--muted);
  font-size:14px;
}

.content h1{
  font-size:2rem;
  margin:0 0 0.6em;
  line-height:1.2;
}
.content h2{
  margin-top:2.2em;
  border-bottom:1px solid var(--border);
  padding-bottom:0.3em;
}
.content h3{
  margin-top:2em;
  padding:12px 14px;
  background:var(--soft);
  border-left:4px solid var(--accent);
}

.content p{
  margin:0.9em 0;
}

.content ul{
  padding-left:1.2em;
}
.content li{
  margin:0.4em 0;
}

.content table{
  border-collapse:collapse;
  width:100%;
  display:block;
  overflow-x:auto;
  margin:1.5em 0;
}
.content th,.content td{
  border:1px solid var(--border);
  padding:10px;
  text-align:left;
}

.content pre{
  background:var(--soft);
  padding:14px;
  border-radius:12px;
  overflow:auto;
}

.content code{
  background:var(--soft);
  padding:2px 5px;
  border-radius:6px;
}

/* Affiliate product links */
.content h3 a{
  color:var(--accent);
  font-weight:600;
}

/* Mobile */
@media (max-width:600px){
  .content h1{ font-size:1.6rem; }
}
</style>
</head>
<body>
  <header>
    <div style="max-width:900px;margin:0 auto">
      <a href="./index.html">← Back</a>
      <div class="muted" id="meta"></div>
    </div>
  </header>
  <main>
    <div class="content" id="content">Loading…</div>
  </main>

  <script src="./assets/purify.min.js"></script>
  <script src="./assets/marked.min.js"></script>
  <script>
  (async () => {
    const params = new URLSearchParams(location.search);
    const slug = params.get("slug");
    if(!slug){ document.getElementById("content").textContent = "Missing slug."; return; }

    const manifest = await (await fetch("./manifest.json", {cache:"no-store"})).json();
    const item = manifest.find(x => x.slug === slug);
    if(!item){ document.getElementById("content").textContent = "Not found."; return; }

    document.getElementById("meta").textContent = slug;
    const md = await (await fetch(item.file, {cache:"no-store"})).text();

    const html = marked.parse(md, {mangle:false, headerIds:true});
    const safe = DOMPurify.sanitize(html, {USE_PROFILES:{html:true}});
    document.getElementById("content").innerHTML = safe;

    const h1 = document.querySelector(".content h1");
    if(h1 && h1.textContent){ document.title = h1.textContent; }
  })();
  </script>
</body>
</html>

